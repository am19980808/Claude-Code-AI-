# 営業日報システム 画面定義書

## 改訂履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0 | 2026-02-24 | 初版作成 |

---

## 1. 画面一覧

| 画面ID | 画面名 | URL | アクセス権限 |
|--------|--------|-----|------------|
| SCR-001 | ログイン画面 | `/login` | 全員（未認証） |
| SCR-002 | ダッシュボード | `/dashboard` | 全員（認証済み） |
| SCR-003 | 日報一覧画面（自分） | `/reports` | 営業担当者・上長 |
| SCR-004 | 日報作成画面 | `/reports/new` | 営業担当者 |
| SCR-005 | 日報編集画面 | `/reports/:id/edit` | 営業担当者（自分の日報のみ） |
| SCR-006 | 日報詳細画面 | `/reports/:id` | 全員（認証済み） |
| SCR-007 | 部下日報一覧画面 | `/team/reports` | 上長 |
| SCR-008 | 顧客マスタ一覧画面 | `/master/customers` | 管理者 |
| SCR-009 | 顧客マスタ登録・編集画面 | `/master/customers/new` `/master/customers/:id/edit` | 管理者 |
| SCR-010 | 営業マスタ一覧画面 | `/master/sales-staff` | 管理者 |
| SCR-011 | 営業マスタ登録・編集画面 | `/master/sales-staff/new` `/master/sales-staff/:id/edit` | 管理者 |

---

## 2. 画面遷移図

```
[未認証]
  └── SCR-001 ログイン
        └── SCR-002 ダッシュボード
              ├── SCR-003 日報一覧（自分）
              │     ├── SCR-004 日報作成
              │     │     └── SCR-006 日報詳細
              │     ├── SCR-005 日報編集
              │     └── SCR-006 日報詳細
              │
              ├── SCR-007 部下日報一覧（上長のみ）
              │     └── SCR-006 日報詳細
              │           └── [コメント投稿]
              │
              └── [マスタ管理] （管理者のみ）
                    ├── SCR-008 顧客マスタ一覧
                    │     └── SCR-009 顧客マスタ登録・編集
                    └── SCR-010 営業マスタ一覧
                          └── SCR-011 営業マスタ登録・編集
```

---

## 3. 権限マトリクス

| 機能 | 営業担当者 | 上長 | 管理者 |
|------|----------|------|--------|
| 自分の日報を作成・編集 | ○ | ○ | - |
| 自分の日報を閲覧 | ○ | ○ | - |
| 部下の日報を閲覧 | - | ○ | - |
| 日報にコメントを投稿 | - | ○ | - |
| 顧客マスタの管理 | - | - | ○ |
| 営業マスタの管理 | - | - | ○ |

---

## 4. 画面定義

---

### SCR-001 ログイン画面

**概要**
メールアドレスとパスワードでシステムにログインする画面。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| メールアドレス | テキスト入力 | 登録済みメールアドレス |
| パスワード | パスワード入力 | |
| ログインボタン | ボタン | 認証を実行する |
| エラーメッセージ | テキスト | 認証失敗時に表示 |

**バリデーション**

| 項目 | ルール |
|------|--------|
| メールアドレス | 必須・メール形式 |
| パスワード | 必須 |

**画面遷移**

| 操作 | 遷移先 |
|------|--------|
| ログイン成功 | SCR-002 ダッシュボード |
| ログイン失敗 | SCR-001（エラーメッセージ表示） |

---

### SCR-002 ダッシュボード

**概要**
ログイン後のトップ画面。自分の最近の日報と、未確認コメントを一覧表示する。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| ログインユーザー名 | テキスト | ヘッダーに表示 |
| 今日の日報ショートカット | ボタン | 今日の日報を作成 or 編集画面へ |
| 最近の日報（5件） | 一覧 | 報告日・ステータス・コメント有無を表示 |
| 未確認コメント一覧 | 一覧 | 上長から新着コメントがある日報を表示（営業担当者向け） |
| 未確認日報一覧 | 一覧 | 提出済みで未確認の部下日報件数（上長向け） |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 今日の日報を作成 | SCR-004 日報作成画面 |
| 今日の日報を編集 | SCR-005 日報編集画面 |
| 最近の日報の行をクリック | SCR-006 日報詳細画面 |
| 部下の日報一覧 | SCR-007 部下日報一覧画面 |

---

### SCR-003 日報一覧画面（自分）

**概要**
ログインユーザー自身の日報を一覧表示する画面。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 期間フィルター | 日付範囲入力 | 絞り込み用（デフォルト：当月） |
| ステータスフィルター | セレクト | 全て／下書き／提出済み／確認済み |
| 日報一覧テーブル | テーブル | 下記参照 |
| 新規作成ボタン | ボタン | 右上に固定表示 |

**日報一覧テーブルの列**

| 列名 | 説明 |
|------|------|
| 報告日 | YYYY/MM/DD 形式 |
| ステータス | 下書き／提出済み／確認済み／差し戻し |
| 訪問先件数 | 当日の訪問記録件数 |
| コメント | 上長コメントあり → バッジ表示（未読は強調） |
| 操作 | 詳細／編集（下書きのみ） |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 新規作成ボタン | SCR-004 日報作成画面 |
| 詳細リンク | SCR-006 日報詳細画面 |
| 編集リンク | SCR-005 日報編集画面 |

---

### SCR-004 日報作成画面

**概要**
新しい日報を作成する画面。訪問記録を複数行追加できる。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 報告日 | 日付入力 | デフォルト：本日の日付 |
| **訪問記録セクション** | | |
| 訪問記録リスト | 繰り返しフォーム | 複数行追加可能 |
| ┗ 顧客名 | セレクト | 顧客マスタから選択 |
| ┗ 訪問内容 | テキストエリア | 訪問時の商談内容・状況など |
| ┗ 訪問時刻 | 時刻入力 | 任意 |
| ┗ 行削除ボタン | ボタン | その行を削除 |
| 訪問記録を追加ボタン | ボタン | 行を1行追加する |
| **課題・相談セクション** | | |
| 今の課題・相談 | テキストエリア | 現在の課題や相談事項を自由記述 |
| **翌日行動セクション** | | |
| 明日やること | テキストエリア | 翌日の行動予定を自由記述 |
| **フッターボタン** | | |
| 下書き保存ボタン | ボタン | ステータス「下書き」で保存 |
| 提出ボタン | ボタン | ステータス「提出済み」に変更して保存 |
| キャンセルボタン | ボタン | SCR-003 へ戻る |

**バリデーション**

| 項目 | ルール |
|------|--------|
| 報告日 | 必須・日付形式・同一日付の日報が既に存在しないこと |
| 顧客名（訪問記録） | 訪問記録を追加した行は必須 |
| 訪問内容（訪問記録） | 訪問記録を追加した行は必須・最大1000文字 |
| 今の課題・相談 | 任意・最大2000文字 |
| 明日やること | 任意・最大2000文字 |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 下書き保存 | SCR-006 日報詳細画面 |
| 提出 | SCR-006 日報詳細画面 |
| キャンセル | SCR-003 日報一覧画面 |

---

### SCR-005 日報編集画面

**概要**
既存の日報を編集する画面。下書き状態または差し戻し状態の日報のみ編集可能。

**表示項目**

SCR-004 日報作成画面と同一。ただし既存データがプリフィルされた状態で表示される。

**編集制限**

| 条件 | 編集可否 |
|------|---------|
| ステータスが「下書き」 | 編集可 |
| ステータスが「差し戻し」 | 編集可 |
| ステータスが「提出済み」 | 編集不可（詳細画面にリダイレクト） |
| ステータスが「確認済み」 | 編集不可（詳細画面にリダイレクト） |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 下書き保存 | SCR-006 日報詳細画面 |
| 提出 | SCR-006 日報詳細画面 |
| キャンセル | SCR-006 日報詳細画面 |

---

### SCR-006 日報詳細画面

**概要**
日報の詳細を閲覧する画面。上長はここからコメントを投稿できる。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 報告日 | テキスト | |
| 営業担当者名 | テキスト | |
| ステータスバッジ | バッジ | 下書き／提出済み／確認済み／差し戻し |
| **訪問記録セクション** | | |
| 訪問記録テーブル | テーブル | 顧客名・訪問内容・訪問時刻を一覧表示 |
| **課題・相談セクション** | | |
| 今の課題・相談 | テキスト | |
| **翌日行動セクション** | | |
| 明日やること | テキスト | |
| **コメントセクション** | | |
| コメント一覧 | リスト | 投稿者名・投稿日時・コメント内容を時系列表示 |
| コメント入力欄 | テキストエリア | 上長のみ表示 |
| コメント送信ボタン | ボタン | 上長のみ表示 |
| **フッターボタン** | | |
| 編集ボタン | ボタン | 自分の日報かつ下書き or 差し戻し時のみ表示 |
| 確認済みにするボタン | ボタン | 上長のみ・ステータスが提出済みの時のみ表示 |
| 差し戻しボタン | ボタン | 上長のみ・ステータスが提出済みの時のみ表示 |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 編集ボタン | SCR-005 日報編集画面 |
| コメント送信 | SCR-006（同画面リロード） |
| 確認済みにする | SCR-006（ステータス更新） |
| 差し戻し | SCR-006（差し戻し理由モーダル → ステータス更新） |
| 戻るリンク | SCR-003 または SCR-007（遷移元による） |

---

### SCR-007 部下日報一覧画面

**概要**
上長が自分の部下全員の日報を一覧で確認する画面。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 担当者フィルター | セレクト | 全員 or 特定の部下を選択 |
| 期間フィルター | 日付範囲入力 | デフォルト：当月 |
| ステータスフィルター | セレクト | 全て／提出済み／確認済み／差し戻し |
| 日報一覧テーブル | テーブル | 下記参照 |

**日報一覧テーブルの列**

| 列名 | 説明 |
|------|------|
| 報告日 | YYYY/MM/DD 形式 |
| 担当者名 | 日報を書いた営業担当者名 |
| ステータス | 提出済み／確認済み／差し戻し |
| 訪問先件数 | |
| 未読コメント | 自分がコメントした後に日報が更新された場合に表示 |
| 操作 | 詳細リンク |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 詳細リンク | SCR-006 日報詳細画面 |

---

### SCR-008 顧客マスタ一覧画面

**概要**
顧客情報を一覧表示・管理する画面。管理者のみアクセス可能。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 検索ボックス | テキスト入力 | 顧客名・業種で絞り込み |
| 顧客一覧テーブル | テーブル | 下記参照 |
| 新規登録ボタン | ボタン | 右上に表示 |

**顧客一覧テーブルの列**

| 列名 | 説明 |
|------|------|
| 顧客ID | |
| 顧客名 | |
| 業種 | |
| 電話番号 | |
| 担当営業 | |
| 操作 | 編集／削除 |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 新規登録ボタン | SCR-009 顧客マスタ登録画面 |
| 編集リンク | SCR-009 顧客マスタ編集画面 |
| 削除リンク | 確認ダイアログ → 削除実行 → SCR-008 |

---

### SCR-009 顧客マスタ登録・編集画面

**概要**
顧客情報を登録・編集する画面。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 顧客名 | テキスト入力 | 必須 |
| 業種 | テキスト入力 | |
| 住所 | テキスト入力 | |
| 電話番号 | テキスト入力 | |
| 担当営業 | セレクト | 営業マスタから選択 |
| 保存ボタン | ボタン | |
| キャンセルボタン | ボタン | |

**バリデーション**

| 項目 | ルール |
|------|--------|
| 顧客名 | 必須・最大100文字 |
| 電話番号 | 任意・電話番号形式 |
| 担当営業 | 任意 |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 保存 | SCR-008 顧客マスタ一覧画面 |
| キャンセル | SCR-008 顧客マスタ一覧画面 |

---

### SCR-010 営業マスタ一覧画面

**概要**
営業担当者情報を一覧表示・管理する画面。管理者のみアクセス可能。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 検索ボックス | テキスト入力 | 氏名・部署で絞り込み |
| 営業担当者一覧テーブル | テーブル | 下記参照 |
| 新規登録ボタン | ボタン | 右上に表示 |

**営業担当者一覧テーブルの列**

| 列名 | 説明 |
|------|------|
| 営業ID | |
| 氏名 | |
| メールアドレス | |
| 部署 | |
| 上長フラグ | ○／- |
| 上長名 | 紐づく上長の氏名 |
| 操作 | 編集／削除 |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 新規登録ボタン | SCR-011 営業マスタ登録画面 |
| 編集リンク | SCR-011 営業マスタ編集画面 |
| 削除リンク | 確認ダイアログ → 削除実行 → SCR-010 |

---

### SCR-011 営業マスタ登録・編集画面

**概要**
営業担当者情報を登録・編集する画面。

**表示項目**

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 氏名 | テキスト入力 | 必須 |
| メールアドレス | テキスト入力 | 必須・ログインIDになる |
| パスワード | パスワード入力 | 新規登録時は必須、編集時は空欄で変更なし |
| 部署 | テキスト入力 | |
| 上長フラグ | チェックボックス | ONにすると部下の日報へのコメントが可能になる |
| 上長 | セレクト | 自分の上長を選択（営業マスタから is_manager=true の人のみ） |
| 保存ボタン | ボタン | |
| キャンセルボタン | ボタン | |

**バリデーション**

| 項目 | ルール |
|------|--------|
| 氏名 | 必須・最大50文字 |
| メールアドレス | 必須・メール形式・重複不可 |
| パスワード | 新規登録時必須・8文字以上 |

**操作**

| 操作 | 遷移先 |
|------|--------|
| 保存 | SCR-010 営業マスタ一覧画面 |
| キャンセル | SCR-010 営業マスタ一覧画面 |

---

## 5. 共通仕様

### ヘッダー

全画面共通で表示。

| 要素 | 説明 |
|------|------|
| システム名 | 「営業日報システム」 |
| ログインユーザー名 | 右上に表示 |
| ナビゲーションメニュー | ダッシュボード・日報一覧・部下日報（上長）・マスタ管理（管理者） |
| ログアウトボタン | 右上に表示 |

### エラー表示

| 種別 | 表示方法 |
|------|---------|
| 入力バリデーションエラー | 各入力項目の下にインラインで赤字表示 |
| サーバーエラー | 画面上部にトーストまたはアラートで表示 |
| 権限エラー | 403ページを表示 |
| 存在しないリソース | 404ページを表示 |

### ステータスの表示色

| ステータス | 表示色 |
|-----------|--------|
| 下書き | グレー |
| 提出済み | ブルー |
| 確認済み | グリーン |
| 差し戻し | レッド |
